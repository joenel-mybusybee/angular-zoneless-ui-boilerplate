import{a as w}from"./chunk-UJGH4TKB.js";import{b as y}from"./chunk-IZ3LLJO2.js";import{a as N,b as W,d as D,e as U,f as B,g as H,h as z,o as G,q as J,s as K}from"./chunk-VWJHJAMU.js";import{d as q,f as F,g as A,j as I}from"./chunk-52TRBPRN.js";import{n as j}from"./chunk-ELZ3HLUI.js";import{Ab as _,Ga as r,Hb as p,K as S,La as C,Lb as d,Nb as M,Pb as h,Qb as b,Ra as P,Rb as v,Xb as k,ga as u,ha as f,hb as s,ia as L,ib as m,ja as E,mb as V,nb as t,nc as O,ob as n,pb as x,ub as R,yb as T}from"./chunk-DQHNRFYU.js";var X=["class","component"];function Y(e,i){if(e&1&&(t(0,"div",11),d(1),n()),e&2){let o=_();r(),M(" ",o.infoMessage," ")}}function Z(e,i){e&1&&(t(0,"span"),d(1,"Email is required."),n())}function $(e,i){e&1&&(t(0,"span"),d(1,"Please enter a valid username address."),n())}function ee(e,i){if(e&1&&(t(0,"div",15),s(1,Z,2,0,"span"),s(2,$,2,0,"span"),n()),e&2){_();let o=p(15);r(),m(o.errors!=null&&o.errors.required?1:-1),r(),m(o.errors!=null&&o.errors.username?2:-1)}}function ne(e,i){e&1&&(t(0,"span"),d(1,"Password is required."),n())}function te(e,i){e&1&&(t(0,"span"),d(1,"Password must be at least 6 characters long."),n())}function ie(e,i){if(e&1&&(t(0,"div",15),s(1,ne,2,0,"span"),s(2,te,2,0,"span"),n()),e&2){_();let o=p(21);r(),m(o.errors!=null&&o.errors.required?1:-1),r(),m(o.errors!=null&&o.errors.minlength?2:-1)}}function oe(e,i){e&1&&x(0,"span",24)}function re(e,i){e&1&&(t(0,"span",25),d(1,"Sign in"),n())}function ae(e,i){e&1&&(t(0,"span",25),d(1,"Signing in..."),n())}function le(e,i){if(e&1&&(t(0,"div",26),d(1),n()),e&2){let o=_();r(),M(" ",o.error," ")}}var Q=class e{constructor(i,o,a,c){this.cd=i;this.authService=o;this.route=a;this.router=c}credentials={username:"",password:""};isRemembered=!1;loading=!1;error=null;infoMessage=null;returnUrl=null;ngOnInit(){this.route.queryParamMap.subscribe(i=>{this.infoMessage=i.get("message"),this.returnUrl=i.get("returnUrl"),this.cd.detectChanges()})}login(){this.loading=!0,this.error=null,this.authService.login(this.credentials,this.isRemembered).pipe(S(()=>{this.loading=!1,this.cd.detectChanges()})).subscribe({next:i=>{i&&i.accessToken?this.returnUrl?this.router.navigateByUrl(this.returnUrl):this.router.navigate(["/main/dashboard"]):this.error=y.loginFailed},error:i=>{this.error=i?.error?.message||y.loginFailed,console.error("Login error:",i)}})}static \u0275fac=function(o){return new(o||e)(C(O),C(w),C(q),C(F))};static \u0275cmp=P({type:e,selectors:[["app-login",8,"component"]],features:[k([w])],attrs:X,decls:35,vars:11,consts:[["loginForm","ngForm"],["username","ngModel"],["password","ngModel"],[1,"container-fluid","min-vh-100","d-flex","flex-column","justify-content-center","align-items-center","bg-light"],[1,"card","shadow-lg","p-4",2,"max-width","400px","width","100%"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"fs-3","fw-bold","text-primary"],["routerLink","/","title","Back to Home",1,"btn","btn-light","btn-circle","shadow-sm","d-flex","align-items-center","justify-content-center",2,"width","2.5rem","height","2.5rem","padding","0"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-house-door"],["d","M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 2 7.5V14a1 1 0 0 0 1 1h3.5a.5.5 0 0 0 .5-.5V11a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v3.5a.5.5 0 0 0 .5.5H13a1 1 0 0 0 1-1V7.5a.5.5 0 0 0-.146-.354l-6-6zM13 14H9.5V11a1.5 1.5 0 0 0-3 0v3H3V7.707l5-5 5 5V14z"],["autocomplete","off","novalidate","",3,"ngSubmit"],[1,"alert","alert-info","mb-3","py-2","px-3","small","text-center"],[1,"mb-3"],["for","username",1,"form-label"],["type","username","id","username","name","username","required","","username","",1,"form-control",3,"ngModelChange","ngModel"],[1,"text-danger","small","mt-1"],["for","password",1,"form-label"],["type","password","id","password","name","password","required","","minlength","6",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"form-check"],["type","checkbox","id","rememberMe","name","rememberMe",1,"form-check-input",3,"ngModelChange","ngModel"],["for","rememberMe",1,"form-check-label"],["routerLink","/forgot-password",1,"small","text-decoration-none"],["type","submit",1,"btn","btn-primary","w-100","py-2","d-flex","align-items-center","justify-content-center",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"me-2"],[1,"alert","alert-danger","mt-3","mb-0","py-2","px-3","small","text-center"]],template:function(o,a){if(o&1){let c=R();t(0,"div",3)(1,"div",4)(2,"div",5)(3,"span",6),d(4,"Login"),n(),t(5,"a",7),L(),t(6,"svg",8),x(7,"path",9),n()()(),E(),t(8,"form",10,0),T("ngSubmit",function(){return u(c),f(a.login())}),s(10,Y,2,1,"div",11),t(11,"div",12)(12,"label",13),d(13,"Username"),n(),t(14,"input",14,1),v("ngModelChange",function(l){return u(c),b(a.credentials.username,l)||(a.credentials.username=l),f(l)}),n(),s(16,ee,3,2,"div",15),n(),t(17,"div",12)(18,"label",16),d(19,"Password"),n(),t(20,"input",17,2),v("ngModelChange",function(l){return u(c),b(a.credentials.password,l)||(a.credentials.password=l),f(l)}),n(),s(22,ie,3,2,"div",15),n(),t(23,"div",18)(24,"div",19)(25,"input",20),v("ngModelChange",function(l){return u(c),b(a.isRemembered,l)||(a.isRemembered=l),f(l)}),n(),t(26,"label",21),d(27,"Remember me"),n()(),t(28,"a",22),d(29,"Forgot password?"),n()(),t(30,"button",23),s(31,oe,1,0,"span",24),s(32,re,2,0,"span",25),s(33,ae,2,0,"span",25),n(),s(34,le,2,1,"div",26),n()()()}if(o&2){let c=p(9),g=p(15),l=p(21);r(10),m(a.infoMessage?10:-1),r(4),h("ngModel",a.credentials.username),r(2),m(g.invalid&&(g.touched||g.dirty)?16:-1),r(4),h("ngModel",a.credentials.password),r(2),m(l.invalid&&(l.touched||l.dirty)?22:-1),r(3),h("ngModel",a.isRemembered),r(5),V("disabled",c.invalid||a.loading),r(),m(a.loading?31:-1),r(),m(a.loading?-1:32),r(),m(a.loading?33:-1),r(),m(a.error?34:-1)}},dependencies:[j,K,z,W,N,D,U,G,J,H,B,I,A],styles:["a.btn-circle[_ngcontent-%COMP%]{border-radius:50%;width:2.5rem;height:2.5rem;padding:0;display:flex;align-items:center;justify-content:center;transition:box-shadow .2s,background .2s}a.btn-circle[_ngcontent-%COMP%]:hover, a.btn-circle[_ngcontent-%COMP%]:focus{background:#e9ecef;box-shadow:0 2px 8px #0000001f}body[_ngcontent-%COMP%], .container-fluid[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#e0e7ef)}.card[_ngcontent-%COMP%]{border-radius:1.5rem;border:none}.btn-primary[_ngcontent-%COMP%]{font-size:1.1rem;border-radius:2rem;box-shadow:0 2px 8px #00000014}.form-label[_ngcontent-%COMP%]{font-weight:500}.form-control[_ngcontent-%COMP%]:focus{border-color:#0d6efd;box-shadow:0 0 0 .2rem #0d6efd26}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#0d6efd;border-color:#0d6efd}a[_ngcontent-%COMP%]{color:#0d6efd;transition:color .2s}a[_ngcontent-%COMP%]:hover{color:#0a58ca}"]})};export{Q as LoginComponent};
