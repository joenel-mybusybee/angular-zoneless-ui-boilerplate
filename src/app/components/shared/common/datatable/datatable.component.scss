$virtual-scroll-height: calc(90vh - 200px);
$virtual-scroll-min-height: 350px;

.datatable-container {
  .datatable-header {
    background-color: var(--bs-gray-100);
    padding: 1rem;
    border-radius: 0.375rem;
  }

  .search-container {
    min-width: 250px;
  }

  .datatable-footer-actions {
    .data-info {
      font-size: 0.875rem;
    }

    .footer-actions {
      display: flex;
      gap: 0.5rem;
    }
  }

  ::ng-deep {
    // Hide default sort icons
    .datatable-header-cell-template-wrap {
      .datatable-header-cell-wrapper {
        display: none !important;
      }
    }

    ::ng-deep .ngx-datatable.virtual-scroll {
      height: $virtual-scroll-height !important;
      min-height: $virtual-scroll-min-height;

      .datatable-header {
        position: relative;
        z-index: 1;
      }

      .datatable-header-inner {
        position: sticky;
        top: 0;
        background: var(--bs-gray-100);
      }

      .datatable-body {
        height: auto;
        max-height: calc(100% - 50px) !important;
      }

      &.fixed-header .datatable-header {
        height: 50px !important;
        overflow: hidden;
      }
    }

    // Custom header styles
    .ngx-datatable-header {
      .sortable {
        &:hover {
          .bi-arrow-down-up {
            opacity: 1;
          }
        }
      }

      .bi-arrow-down-up {
        opacity: 0.5;
        transition: opacity 0.2s;
        font-size: 0.875rem;
      }

      // Show different icons based on sort direction
      .sort-active {
        &.sort-asc .bi-arrow-down-up::before {
          content: '\\F143'; // bi-arrow-up
        }
        &.sort-desc .bi-arrow-down-up::before {
          content: '\\F13C'; // bi-arrow-down
        }
        .bi-arrow-down-up {
          opacity: 1;
        }
      }
    }

    // Table overrides
    .ngx-datatable {
      box-shadow: none;
      border: 1px solid var(--bs-gray-300);
      border-radius: 0.375rem;

      .datatable-header {
        background-color: var(--bs-gray-100);
        border-bottom: 1px solid var(--bs-gray-300);

        .datatable-header-cell {
          font-weight: 600;

          &:hover {
            background-color: var(--bs-gray-200);
          }

          .bi-funnel {
            font-size: 0.875rem;
            opacity: 0.6;

            &:hover {
              opacity: 1;
            }
          }
        }
      }

      .datatable-body {
        .datatable-body-row {
          &:hover {
            background-color: var(--bs-gray-100);
          }

          &.active {
            background-color: var(--bs-primary-bg-subtle);
          }

          .datatable-body-cell {
            padding: 0.5rem;

            // Handle text overflow
            &-value {
              white-space: nowrap;
              overflow: hidden;
              text-overflow: ellipsis;
            }

            .datatable-body-cell-label {
              width: 100%;
              text-overflow: ellipsis;
              overflow: hidden;
              display: block;
            }
          }
        }
      }

      .datatable-footer {
        background-color: var(--bs-gray-100);
        border-top: 1px solid var(--bs-gray-300);

        .page-count {
          line-height: 1.25;
          display: flex;
          align-items: center;
          gap: 0.25rem !important;
        }

        .datatable-pager {
          li {
            &.active a {
              background-color: var(--bs-primary);
              border-color: var(--bs-primary);
              color: #fff;
            }

            &:not(.disabled) a {
              &:hover {
                background-color: var(--bs-gray-200);
              }
            }
          }
        }
      }
    }

    // Form control sizes
    .form-control-sm,
    .form-select-sm {
      height: calc(1.5em + 0.5rem + 2px);
      padding: 0.25rem 0.5rem;
      font-size: 0.875rem;
      line-height: 1.5;
    }

    // Button sizes
    .btn-sm {
      padding: 0.25rem 0.5rem;
      font-size: 0.875rem;
      line-height: 1.5;
    }

    // Action buttons
    .btn-icon {
      padding: 0.25rem;
      line-height: 1;
      border-radius: 0.25rem;

      i {
        font-size: 1rem;
        line-height: 1;
        display: block;
      }
    }
  }

  // Dropdown menu positioning
  .dropdown-menu {
    margin-top: 0.125rem;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);

    .dropdown-item {
      cursor: pointer;

      &:hover {
        background-color: var(--bs-gray-100);
      }

      i {
        width: 1.25rem;
        text-align: center;
        margin-right: 0.5rem;
      }
    }
  }
}
